{% extends "base_generic.html" %}

{% block content %}
    <h1>My Applications</h1>
    <a href="{% url 'applications:application-create' %}">Create new application</a> | <a href ="{% url 'applications:applications-all' %}">All applications</a> | <a href="{% url 'applications:applications-current' %}">Current applications</a> | <a href="{% url 'applications:applications-past' %}">Past applications</a>
    {% if applications_list %}
    <table cellpadding="10" class="sortable">
      <caption>Current Applications</caption>
      <thead class="pointer">
        <tr>
          <th>Company</th>
          <th>Position</th>
          <th>Status</th>
          <th>Date Applied</th>
          <th>Edit/Delete</th>
        </tr>
      </thead>
      <tbody>
    {% for application in applications_list %}
      <tr>
        <td><a href="{{ application.get_absolute_url }}">{{ application.company }}</a></td>
        <td>{{ application.position }}</td>
        <td>
          <script type="text/javascript">
            function changeStatus() {
              if (document.getElementById("a").innerHTML == "Applied"){
                document.getElementById("a").backgroundColor = "blue";
              }
              console.log(document.getElementById("a").innerHTML);
            }
          </script>
          <form id="status-form" name="form" action="{{ application.get_absolute_url }}/change_status/" method="post">
            {% csrf_token %}
            <select id="status" name="status" onchange="this.form.submit(); changeStatus()">
              <option id = "a" selected="selected">{{ application.get_status_display }}</option>
              <option value="p">In Progress</option>
              <option value="i">Interviewing</option>
              <option value="a">Applied</option>
              <option value="d">Denied</option>
              <option value="o">Offered</option>
              <option value="r">Remove</option>
            </select>    
          </form>
        </td>
        <td>{{ application.date_applied }}</td>
        <td><a href="{{ application.get_absolute_url }}/update">Edit</a> or <a href="{{ application.get_absolute_url }}/delete">Delete</a></td>
      </tr>
    {% endfor %}
  </tbody>
    </table>
  {% else %}
    <p>You have no current applications.</p>
  {% endif %}       
{% endblock %}